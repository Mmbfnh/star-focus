<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نجم التركيز - منصة تعليمية متكاملة</title>
    <meta name="description" content="منصة تعليمية متكاملة تساعد الأطفال على تنظيم وقتهم الدراسي وتحفيزهم من خلال نظام المكافآت والنجوم">
    <meta name="keywords" content="تعليم, أطفال, جدول دراسة, مكافآت, تركيز">
    <meta name="author" content="نجم التركيز">
    
    <!-- المكتبات الخارجية -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --dark-gradient: linear-gradient(135deg, #1e293b, #334155);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: 1px solid rgba(255, 255, 255, 0.18);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .glass-effect {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: var(--glass-border);
        }

        .hover-lift {
            transition: all 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        .float-animation { animation: float 3s ease-in-out infinite; }

        .dark-mode { background: var(--dark-gradient); color: #f1f5f9; }
        .dark-mode .glass-effect { background: rgba(30, 41, 59, 0.7); }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #6366f1;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        .notification-success { background: rgba(34, 197, 94, 0.9); }
        .notification-error { background: rgba(239, 68, 68, 0.9); }
        .notification-info { background: rgba(59, 130, 246, 0.9); }

        .priority-high { background: #ef4444; }
        .priority-medium { background: #f59e0b; }
        .priority-low { background: #10b981; }

        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            transition: width 0.3s ease;
        }
        
        .firebase-badge {
            background: linear-gradient(135deg, #ffa000, #ffca28);
            color: #5d4037;
        }

        @media (max-width: 768px) {
            .container-padding {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // Firebase Configuration
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyDEMO_KEY_REPLACE_THIS",
            authDomain: "your-project.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Constants
        const DEFAULT_REWARDS = [
            { id: 1, name: "وسام رقمي", type: "digital", starsRequired: 5, icon: "🏆" },
            { id: 2, name: "وقت لعبة 30 دقيقة", type: "real", starsRequired: 10, icon: "🎮" },
            { id: 3, name: "خروج للحديقة", type: "real", starsRequired: 15, icon: "🌳" },
            { id: 4, name: "وجبة مفضلة", type: "real", starsRequired: 20, icon: "🍕" }
        ];

        const AVATARS = ["👦", "👧", "🧑", "👩", "🦸", "🦹", "🧙", "🧚", "👨‍🚀", "👩‍🚀"];
        const DAYS_OF_WEEK = ["السبت", "الأحد", "الإثنين", "الثلاثاء", "الأربعاء", "الخميس", "الجمعة"];
        const FOCUS_LEVELS = ['منخفض', 'متوسط', 'مرتفع'];
        const PRIORITY_LEVELS = ['منخفض', 'متوسط', 'مرتفع'];

        // Utility Functions
        const utils = {
            calculateAge(birthDate) {
                if (!birthDate) return 0;
                const today = new Date();
                const birth = new Date(birthDate);
                let age = today.getFullYear() - birth.getFullYear();
                const monthDiff = today.getMonth() - birth.getMonth();
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                    age--;
                }
                return age;
            },

            getCurrentDay() {
                const days = ["الأحد", "الإثنين", "الثلاثاء", "الأربعاء", "الخميس", "الجمعة", "السبت"];
                return days[new Date().getDay()];
            },

            formatTime(minutes) {
                const hrs = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return hrs > 0 ? `${hrs} ساعة ${mins} دقيقة` : `${mins} دقيقة`;
            },

            generateId() {
                return Date.now().toString() + Math.random().toString(36).substr(2, 9);
            },

            validateChildData(childData) {
                const errors = [];
                
                if (!childData.name || childData.name.trim().length < 2) {
                    errors.push("اسم الطفل يجب أن يكون على الأقل حرفين");
                }
                
                if (childData.birthDate) {
                    const birthDate = new Date(childData.birthDate);
                    const today = new Date();
                    if (birthDate > today) {
                        errors.push("تاريخ الميلاد لا يمكن أن يكون في المستقبل");
                    }
                }
                
                if (childData.subjects.length === 0) {
                    errors.push("يجب إضافة مادة واحدة على الأقل");
                }
                
                return errors;
            }
        };

        // Firebase Service
        const firebaseService = {
            db: null,
            initialized: false,

            init() {
                try {
                    const app = firebase.initializeApp(FIREBASE_CONFIG);
                    this.db = firebase.firestore();
                    this.initialized = true;
                    return true;
                } catch (error) {
                    console.error("Firebase initialization failed:", error);
                    return false;
                }
            },

            async getCollection(collectionName) {
                if (!this.initialized) return [];
                try {
                    const snapshot = await this.db.collection(collectionName).get();
                    return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                } catch (error) {
                    console.error(`Error getting ${collectionName}:`, error);
                    return [];
                }
            },

            async saveDocument(collectionName, document) {
                if (!this.initialized) return null;
                try {
                    if (document.id && document.id.length > 10) {
                        await this.db.collection(collectionName).doc(document.id).set(document, { merge: true });
                        return document.id;
                    } else {
                        const docRef = await this.db.collection(collectionName).add(document);
                        return docRef.id;
                    }
                } catch (error) {
                    console.error(`Error saving to ${collectionName}:`, error);
                    return null;
                }
            },

            async deleteDocument(collectionName, docId) {
                if (!this.initialized) return false;
                try {
                    await this.db.collection(collectionName).doc(docId).delete();
                    return true;
                } catch (error) {
                    console.error(`Error deleting from ${collectionName}:`, error);
                    return false;
                }
            }
        };

        // Main App Component
        const { useState, useEffect, useCallback, useMemo } = React;

        function App() {
            const [appState, setAppState] = useState({
                step: 0,
                children: [],
                currentChildIndex: 0,
                activeTab: "الرئيسية",
                darkMode: false,
                useFirebase: false,
                loading: false
            });

            const [newChild, setNewChild] = useState({
                name: "",
                birthDate: "",
                focusLevel: "متوسط",
                wakeTime: "05:30",
                sleepTime: "20:30",
                subjects: [],
                exams: [],
                weeklySchedule: Object.fromEntries(DAYS_OF_WEEK.map(day => [day, []])),
                goals: [],
                stars: 0,
                completed: [],
                achievements: [],
                studyTime: 0,
                avatar: "👦",
                createdAt: new Date().toISOString()
            });

            const [rewards, setRewards] = useState(DEFAULT_REWARDS);
            const [notification, setNotification] = useState({ show: false, message: "", type: "" });
            const [studyTimer, setStudyTimer] = useState({ active: false, startTime: null, currentSubject: null });
            const [dailyPlan, setDailyPlan] = useState([]);

            // Initialize Firebase
            useEffect(() => {
                const initFirebase = async () => {
                    setAppState(prev => ({ ...prev, loading: true }));
                    
                    if (firebaseService.init()) {
                        setAppState(prev => ({ ...prev, useFirebase: true }));
                        showNotification("✅ تم الاتصال بقاعدة البيانات السحابية", "success");
                        
                        // Load data from Firebase
                        const [childrenData, rewardsData] = await Promise.all([
                            firebaseService.getCollection('children'),
                            firebaseService.getCollection('rewards')
                        ]);
                        
                        if (childrenData.length > 0) {
                            setAppState(prev => ({ ...prev, children: childrenData }));
                        }
                        if (rewardsData.length > 0) {
                            setRewards(rewardsData);
                        }
                    } else {
                        loadFromLocalStorage();
                    }
                    
                    setAppState(prev => ({ ...prev, loading: false }));
                };

                initFirebase();
            }, []);

            // Local Storage Management
            const loadFromLocalStorage = useCallback(() => {
                const storedChildren = localStorage.getItem("childrenData");
                const storedRewards = localStorage.getItem("rewardsData");
                const storedDarkMode = localStorage.getItem("darkMode");
                
                if (storedChildren) setAppState(prev => ({ ...prev, children: JSON.parse(storedChildren) }));
                if (storedRewards) setRewards(JSON.parse(storedRewards));
                if (storedDarkMode) setAppState(prev => ({ ...prev, darkMode: JSON.parse(storedDarkMode) }));
                
                showNotification("تم تحميل البيانات من التخزين المحلي", "info");
            }, []);

            const saveToLocalStorage = useCallback(() => {
                localStorage.setItem("childrenData", JSON.stringify(appState.children));
                localStorage.setItem("rewardsData", JSON.stringify(rewards));
                localStorage.setItem("darkMode", JSON.stringify(appState.darkMode));
            }, [appState.children, rewards, appState.darkMode]);

            // Auto-save
            useEffect(() => {
                if (appState.children.length > 0 || rewards.length > 0) {
                    saveToLocalStorage();
                    
                    // Sync with Firebase if enabled
                    if (appState.useFirebase) {
                        appState.children.forEach(child => {
                            firebaseService.saveDocument('children', child);
                        });
                        rewards.forEach(reward => {
                            firebaseService.saveDocument('rewards', reward);
                        });
                    }
                }
            }, [appState.children, rewards, appState.darkMode, appState.useFirebase, saveToLocalStorage]);

            // Study Timer
            useEffect(() => {
                let interval;
                if (studyTimer.active && studyTimer.startTime) {
                    interval = setInterval(() => {
                        setAppState(prev => ({
                            ...prev,
                            children: prev.children.map((child, index) => 
                                index === prev.currentChildIndex 
                                    ? { ...child, studyTime: child.studyTime + 1 }
                                    : child
                            )
                        }));
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [studyTimer.active, appState.currentChildIndex]);

            // Notification System
            const showNotification = useCallback((message, type = "info") => {
                setNotification({ show: true, message, type });
                setTimeout(() => setNotification({ show: false, message: "", type: "" }), 4000);
            }, []);

            // Child Management
            const addChild = useCallback((childData) => {
                const validationErrors = utils.validateChildData(childData);
                if (validationErrors.length > 0) {
                    validationErrors.forEach(error => showNotification(error, "error"));
                    return;
                }

                const childWithId = { ...childData, id: utils.generateId() };
                setAppState(prev => ({
                    ...prev,
                    children: [...prev.children, childWithId],
                    step: 1
                }));
                showNotification(`تمت إضافة الطفل ${childData.name} بنجاح`, "success");
            }, [showNotification]);

            const updateChild = useCallback((childIndex, updates) => {
                setAppState(prev => ({
                    ...prev,
                    children: prev.children.map((child, index) =>
                        index === childIndex ? { ...child, ...updates } : child
                    )
                }));
            }, []);

            const deleteChild = useCallback((childIndex) => {
                const childName = appState.children[childIndex]?.name;
                if (!childName || !window.confirm(`هل أنت متأكد من حذف ${childName}؟`)) return;

                setAppState(prev => ({
                    ...prev,
                    children: prev.children.filter((_, index) => index !== childIndex),
                    currentChildIndex: prev.currentChildIndex >= childIndex && prev.currentChildIndex > 0 
                        ? prev.currentChildIndex - 1 
                        : prev.currentChildIndex
                }));

                if (appState.useFirebase) {
                    firebaseService.deleteDocument('children', appState.children[childIndex].id);
                }

                showNotification(`تم حذف الطفل ${childName}`, "info");
            }, [appState.children, appState.useFirebase, showNotification]);

            // Study Timer Management
            const startStudyTimer = useCallback((subjectName) => {
                setStudyTimer({
                    active: true,
                    startTime: new Date(),
                    currentSubject: subjectName
                });
                showNotification(`بدأت جلسة الدراسة لـ ${subjectName}`, "success");
            }, [showNotification]);

            const stopStudyTimer = useCallback(() => {
                if (studyTimer.active && studyTimer.startTime) {
                    const endTime = new Date();
                    const duration = Math.round((endTime - studyTimer.startTime) / 1000 / 60);
                    const extraStars = Math.floor(duration / 15);
                    
                    if (extraStars > 0) {
                        const currentChild = appState.children[appState.currentChildIndex];
                        if (currentChild) {
                            updateChild(appState.currentChildIndex, {
                                stars: currentChild.stars + extraStars
                            });
                            showNotification(`ممتاز! درست ${duration} دقيقة وكسبت ${extraStars} نجوم إضافية ⭐`, "success");
                        }
                    }
                    
                    setStudyTimer({ active: false, startTime: null, currentSubject: null });
                }
            }, [studyTimer, appState.currentChildIndex, appState.children, updateChild, showNotification]);

            // Generate Daily Plan
            const generateDailyPlan = useCallback(() => {
                const currentChild = appState.children[appState.currentChildIndex];
                if (!currentChild) {
                    showNotification("لا يوجد طفل محدد", "error");
                    return;
                }
                
                const plan = [
                    { id: 1, time: currentChild.wakeTime, activity: "استيقاظ وفطور", type: "routine" },
                    { id: 2, time: "06:00-07:00", activity: "تحضير للمدرسة", type: "routine" },
                    { id: 3, time: "07:00-14:00", activity: "الدراسة في المدرسة", type: "school" }
                ];

                currentChild.subjects.forEach((subject, index) => {
                    plan.push({
                        id: 4 + index,
                        time: `${14 + index}:00-${14 + index + 1}:00`,
                        activity: `مذاكرة ${subject.name}`,
                        type: "study",
                        subject: subject.name,
                        duration: subject.duration
                    });
                });

                plan.push(
                    { id: 100, time: "17:00-18:00", activity: "نشاط بدني", type: "physical" },
                    { id: 101, time: currentChild.sleepTime, activity: "تحضير للنوم", type: "routine" }
                );

                setDailyPlan(plan);
                showNotification("تم إنشاء الجدول اليومي", "success");
            }, [appState.currentChildIndex, appState.children, showNotification]);

            // Toggle Complete Activity
            const toggleComplete = useCallback((activityId) => {
                const currentChild = appState.children[appState.currentChildIndex];
                if (!currentChild) return;

                const isCompleted = currentChild.completed.includes(activityId);
                const updatedCompleted = isCompleted
                    ? currentChild.completed.filter(id => id !== activityId)
                    : [...currentChild.completed, activityId];

                updateChild(appState.currentChildIndex, {
                    completed: updatedCompleted,
                    stars: isCompleted ? Math.max(0, currentChild.stars - 1) : currentChild.stars + 1
                });

                if (!isCompleted) {
                    showNotification(`مبروك! كسبت نجمة ⭐`, "success");
                }
            }, [appState.currentChildIndex, appState.children, updateChild, showNotification]);

            // Export/Import Data
            const exportData = useCallback(() => {
                const data = {
                    children: appState.children,
                    rewards: rewards,
                    exportDate: new Date().toISOString(),
                    version: "2.0"
                };
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `star-focus-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                showNotification("تم تصدير البيانات بنجاح", "success");
            }, [appState.children, rewards, showNotification]);

            const importData = useCallback((event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.children) setAppState(prev => ({ ...prev, children: data.children }));
                        if (data.rewards) setRewards(data.rewards);
                        showNotification("تم استيراد البيانات بنجاح", "success");
                    } catch (error) {
                        showNotification("خطأ في استيراد البيانات", "error");
                        console.error("Error importing data:", error);
                    }
                };
                reader.readAsText(file);
                event.target.value = '';
            }, [showNotification]);

            // Current Child Helper
            const currentChild = appState.children[appState.currentChildIndex];

            // Advanced Stats
            const studyProgress = useMemo(() => {
                if (!currentChild || !currentChild.subjects.length) return 0;
                const totalStudyTime = currentChild.studyTime / 60;
                const targetStudyTime = currentChild.subjects.reduce((total, subject) => total + subject.duration, 0);
                return Math.min((totalStudyTime / targetStudyTime) * 100, 100);
            }, [currentChild]);

            const goalProgress = useMemo(() => {
                if (!currentChild || !currentChild.goals.length) return 0;
                const completedGoals = currentChild.goals.filter(g => g.completed).length;
                return (completedGoals / currentChild.goals.length) * 100;
            }, [currentChild]);

            // Check Upcoming Exams
            useEffect(() => {
                if (!currentChild) return;
                
                const today = new Date();
                currentChild.exams.forEach(exam => {
                    const examDate = new Date(exam.date);
                    const daysDifference = Math.ceil((examDate - today) / (1000 * 60 * 60 * 24));
                    
                    if (daysDifference <= 3 && daysDifference >= 0) {
                        showNotification(`تنبيه: اختبار ${exam.subject} بعد ${daysDifference} أيام`, "info");
                    }
                });
            }, [currentChild, showNotification]);

            return (
                <div className={`min-h-screen transition-colors duration-300 ${appState.darkMode ? 'dark-mode' : 'bg-gradient-to-br from-blue-50 to-purple-50'}`}>
                    <div className="max-w-7xl mx-auto p-4 container-padding">
                        {/* Notifications */}
                        {notification.show && (
                            <div className={`fixed top-4 left-4 right-4 z-50 p-4 rounded-lg shadow-lg fade-in glass-effect ${
                                notification.type === "success" ? "notification-success" :
                                notification.type === "error" ? "notification-error" :
                                "notification-info"
                            }`}>
                                <div className="flex justify-between items-center">
                                    <span className="text-lg text-white">{notification.message}</span>
                                    <button 
                                        onClick={() => setNotification({ show: false, message: "", type: "" })} 
                                        className="text-lg font-bold hover:opacity-70 text-white"
                                    >
                                        ×
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Loading Overlay */}
                        {appState.loading && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                <div className="glass-effect rounded-2xl p-8 flex flex-col items-center">
                                    <div className="loading-spinner mb-4"></div>
                                    <div className="text-white text-lg">جاري تحميل البيانات...</div>
                                </div>
                            </div>
                        )}

                        {/* Header */}
                        <header className="text-center mb-8 pt-4">
                            <div className="flex justify-between items-center mb-4">
                                <div className="flex gap-2">
                                    <button 
                                        onClick={() => setAppState(prev => ({ ...prev, darkMode: !prev.darkMode }))}
                                        className="p-3 rounded-full glass-effect hover-lift"
                                        title={appState.darkMode ? "الوضع النهاري" : "الوضع الليلي"}
                                    >
                                        {appState.darkMode ? "☀️" : "🌙"}
                                    </button>
                                    {appState.useFirebase && (
                                        <div className="p-3 rounded-full glass-effect firebase-badge">
                                            ☁️
                                        </div>
                                    )}
                                </div>
                                
                                <h1 className="text-4xl font-bold text-white flex items-center justify-center gap-2">
                                    <span className="float-animation">⭐</span>
                                    نجم التركيز
                                    <span className="float-animation">⭐</span>
                                </h1>
                                
                                <div className="flex gap-2">
                                    <button 
                                        onClick={exportData}
                                        className="p-3 rounded-full glass-effect hover-lift text-white"
                                        title="تصدير البيانات"
                                    >
                                        📥
                                    </button>
                                    <label className="p-3 rounded-full glass-effect hover-lift text-white cursor-pointer" title="استيراد البيانات">
                                        📤
                                        <input 
                                            type="file" 
                                            accept=".json" 
                                            onChange={importData}
                                            className="hidden"
                                        />
                                    </label>
                                </div>
                            </div>
                            <p className="text-lg opacity-80 text-white">
                                {appState.useFirebase ? "منصة متكاملة مع قاعدة بيانات السحابة" : "منصة متكاملة للتخزين المحلي"}
                            </p>
                        </header>

                        {/* Main Content */}
                        {appState.step === 0 ? (
                            <div className="glass-effect rounded-2xl p-6 shadow-xl fade-in">
                                <div className="max-w-4xl mx-auto">
                                    <h2 className="text-3xl font-bold text-center mb-8 text-white">إضافة طفل جديد</h2>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block mb-2 text-lg text-white">الصورة الرمزية</label>
                                                <div className="flex items-center gap-4">
                                                    <button 
                                                        onClick={() => setNewChild(prev => ({ ...prev, avatar: AVATARS[(AVATARS.indexOf(prev.avatar) + 1) % AVATARS.length] }))}
                                                        className="text-4xl p-4 rounded-2xl glass-effect hover-lift"
                                                    >
                                                        {newChild.avatar}
                                                    </button>
                                                    <span className="text-sm opacity-70 text-white">انقر لتغيير الصورة</span>
                                                </div>
                                            </div>
                                            
                                            <div>
                                                <label className="block mb-2 text-lg text-white">اسم الطفل</label>
                                                <input 
                                                    type="text"
                                                    value={newChild.name}
                                                    onChange={(e) => setNewChild(prev => ({ ...prev, name: e.target.value }))}
                                                    placeholder="أدخل اسم الطفل"
                                                    className="w-full p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block mb-2 text-lg text-white">تاريخ الميلاد</label>
                                                <input 
                                                    type="date"
                                                    value={newChild.birthDate}
                                                    onChange={(e) => setNewChild(prev => ({ ...prev, birthDate: e.target.value }))}
                                                    className="w-full p-3 rounded-xl glass-effect text-white"
                                                />
                                            </div>
                                        </div>
                                        
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block mb-2 text-lg text-white">مستوى التركيز</label>
                                                <div className="flex gap-2">
                                                    {FOCUS_LEVELS.map(level => (
                                                        <button
                                                            key={level}
                                                            onClick={() => setNewChild(prev => ({ ...prev, focusLevel: level }))}
                                                            className={`flex-1 p-4 rounded-xl transition-all ${
                                                                newChild.focusLevel === level 
                                                                    ? 'bg-white bg-opacity-30 text-white shadow-lg' 
                                                                    : 'glass-effect hover-lift text-white'
                                                            }`}
                                                        >
                                                            {level}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                            
                                            <div>
                                                <label className="block mb-2 text-lg text-white">وقت الاستيقاظ</label>
                                                <input 
                                                    type="time"
                                                    value={newChild.wakeTime}
                                                    onChange={(e) => setNewChild(prev => ({ ...prev, wakeTime: e.target.value }))}
                                                    className="w-full p-3 rounded-xl glass-effect text-white"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block mb-2 text-lg text-white">وقت النوم</label>
                                                <input 
                                                    type="time"
                                                    value={newChild.sleepTime}
                                                    onChange={(e) => setNewChild(prev => ({ ...prev, sleepTime: e.target.value }))}
                                                    className="w-full p-3 rounded-xl glass-effect text-white"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="mb-6">
                                        <h3 className="text-xl font-bold mb-4 text-white">المواد الدراسية</h3>
                                        <div className="space-y-2 mb-4">
                                            {newChild.subjects.length === 0 ? (
                                                <p className="text-white text-center py-4">لم يتم إضافة أي مواد بعد</p>
                                            ) : (
                                                newChild.subjects.map((subject, index) => (
                                                    <div key={index} className="flex justify-between items-center p-3 glass-effect rounded-xl">
                                                        <span className="text-white">{subject.name} - {subject.duration} دقيقة</span>
                                                        <button 
                                                            onClick={() => setNewChild(prev => ({
                                                                ...prev,
                                                                subjects: prev.subjects.filter((_, i) => i !== index)
                                                            }))}
                                                            className="text-red-400 hover:text-red-300"
                                                        >
                                                            حذف
                                                        </button>
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                        <button 
                                            onClick={() => {
                                                const name = prompt("أدخل اسم المادة:");
                                                if (!name) return;
                                                
                                                const duration = parseInt(prompt("أدخل مدة المادة بالدقائق:"), 10);
                                                if (isNaN(duration)) {
                                                    showNotification("الرجاء إدخال رقم صحيح للمدة", "error");
                                                    return;
                                                }

                                                setNewChild(prev => ({
                                                    ...prev,
                                                    subjects: [...prev.subjects, { name, duration, id: utils.generateId() }]
                                                }));
                                                showNotification(`تمت إضافة مادة ${name}`, "success");
                                            }}
                                            className="w-full p-3 glass-effect rounded-xl text-white hover:bg-white hover:bg-opacity-20 transition-all"
                                        >
                                            + إضافة مادة جديدة
                                        </button>
                                    </div>
                                    
                                    <button 
                                        onClick={() => addChild(newChild)}
                                        className="w-full bg-white bg-opacity-20 text-white p-4 rounded-2xl text-xl font-bold hover:bg-opacity-30 transition-all"
                                    >
                                        بدء الرحلة التعليمية 🚀
                                    </button>
                                </div>
                            </div>
                        ) : !currentChild ? (
                            <div className="text-center py-12">
                                <p className="text-white text-xl mb-4">لا يوجد أطفال مسجلين</p>
                                <button
                                    onClick={() => setAppState(prev => ({ ...prev, step: 0 }))}
                                    className="bg-blue-500 text-white p-4 rounded-2xl text-lg hover:bg-blue-600 transition-all"
                                >
                                    إضافة أول طفل
                                </button>
                            </div>
                        ) : (
                            <div className="space-y-6 fade-in">
                                {/* Children Bar */}
                                <div className="glass-effect rounded-2xl p-4">
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-2xl font-bold text-white">إدارة الأطفال</h2>
                                        <button
                                            onClick={() => setAppState(prev => ({ ...prev, step: 0 }))}
                                            className="bg-green-500 text-white p-3 rounded-xl hover:bg-green-600 transition-all"
                                        >
                                            + طفل جديد
                                        </button>
                                    </div>
                                    
                                    <div className="flex gap-2 overflow-x-auto pb-2">
                                        {appState.children.map((child, index) => (
                                            <button
                                                key={child.id}
                                                onClick={() => setAppState(prev => ({ ...prev, currentChildIndex: index }))}
                                                className={`p-4 rounded-xl min-w-32 text-center transition-all flex-shrink-0 ${
                                                    appState.currentChildIndex === index 
                                                        ? 'bg-white bg-opacity-30 text-white shadow-lg' 
                                                        : 'glass-effect text-white hover:bg-white hover:bg-opacity-10'
                                                }`}
                                            >
                                                <div className="text-2xl mb-2">{child.avatar}</div>
                                                <div className="font-bold truncate">{child.name}</div>
                                                <div className="text-sm">⭐ {child.stars}</div>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Dashboard */}
                                <div className="glass-effect rounded-2xl p-6">
                                    <div className="flex justify-between items-start mb-6">
                                        <div>
                                            <h2 className="text-3xl font-bold text-white">
                                                {currentChild.name} {currentChild.avatar}
                                            </h2>
                                            <p className="text-white opacity-80">
                                                العمر: {utils.calculateAge(currentChild.birthDate)} سنة • 
                                                المستوى: {currentChild.focusLevel} • 
                                                ⭐ {currentChild.stars} نجمة
                                            </p>
                                            <div className="flex gap-4 mt-4">
                                                <div className="text-center">
                                                    <div className="text-2xl text-white">{currentChild.subjects.length}</div>
                                                    <div className="text-white opacity-80">مادة</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-2xl text-white">{currentChild.exams.length}</div>
                                                    <div className="text-white opacity-80">اختبار</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-2xl text-white">{Math.floor(currentChild.studyTime / 60)}</div>
                                                    <div className="text-white opacity-80">دقيقة دراسة</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-2xl text-white">{currentChild.goals.filter(g => g.completed).length}</div>
                                                    <div className="text-white opacity-80">هدف مكتمل</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div className="flex gap-2">
                                            <button
                                                onClick={generateDailyPlan}
                                                className="bg-green-500 text-white p-3 rounded-xl hover:bg-green-600 transition-all"
                                            >
                                                توليد الجدول
                                            </button>
                                            <button
                                                onClick={() => {
                                                    if (window.confirm("هل تريد إعادة تعيين التقدم؟")) {
                                                        updateChild(appState.currentChildIndex, {
                                                            stars: 0,
                                                            completed: [],
                                                            studyTime: 0,
                                                            goals: currentChild.goals.map(goal => ({ ...goal, completed: false }))
                                                        });
                                                        showNotification("تم إعادة التعيين", "info");
                                                    }
                                                }}
                                                className="bg-gray-500 text-white p-3 rounded-xl hover:bg-gray-600 transition-all"
                                            >
                                                إعادة تعيين
                                            </button>
                                            <button
                                                onClick={() => deleteChild(appState.currentChildIndex)}
                                                className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                                            >
                                                حذف
                                            </button>
                                        </div>
                                    </div>

                                    {/* التنقل بين الصفحات */}
                                    <div className="flex overflow-x-auto gap-2 mb-6 pb-2">
                                        {["الرئيسية", "الجدول", "الاختبارات", "الأهداف", "المكافآت", "التقارير"].map(tab => (
                                            <button
                                                key={tab}
                                                onClick={() => setAppState(prev => ({ ...prev, activeTab: tab }))}
                                                className={`px-4 py-2 rounded-xl whitespace-nowrap transition-all flex-shrink-0 ${
                                                    appState.activeTab === tab 
                                                        ? 'bg-white bg-opacity-30 text-white' 
                                                        : 'glass-effect text-white hover:bg-white hover:bg-opacity-10'
                                                }`}
                                            >
                                                {tab}
                                            </button>
                                        ))}
                                    </div>

                                    {/* محتوى التبويبات */}
                                    <div className="fade-in">
                                        {appState.activeTab === "الرئيسية" && (
                                            <div>
                                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                                        <div className="text-3xl mb-2">📚</div>
                                                        <div className="text-white font-bold text-xl">{currentChild.subjects.length}</div>
                                                        <div className="text-white opacity-80">مادة مسجلة</div>
                                                    </div>
                                                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                                        <div className="text-3xl mb-2">⭐</div>
                                                        <div className="text-white font-bold text-xl">{currentChild.stars}</div>
                                                        <div className="text-white opacity-80">نجمة مكتسبة</div>
                                                    </div>
                                                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                                        <div className="text-3xl mb-2">⏱️</div>
                                                        <div className="text-white font-bold text-xl">{Math.floor(currentChild.studyTime / 60)}</div>
                                                        <div className="text-white opacity-80">دقيقة دراسة</div>
                                                    </div>
                                                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                                        <div className="text-3xl mb-2">🎯</div>
                                                        <div className="text-white font-bold text-xl">{currentChild.goals.filter(g => g.completed).length}/{currentChild.goals.length}</div>
                                                        <div className="text-white opacity-80">أهداف مكتملة</div>
                                                    </div>
                                                </div>

                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div className="glass-effect rounded-2xl p-4">
                                                        <h4 className="text-white font-bold mb-3">تقدم الدراسة</h4>
                                                        <div className="progress-bar">
                                                            <div 
                                                                className="progress-fill" 
                                                                style={{ width: `${studyProgress}%` }}
                                                            ></div>
                                                        </div>
                                                        <div className="text-white text-center mt-2">
                                                            {studyProgress.toFixed(1)}%
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="glass-effect rounded-2xl p-4">
                                                        <h4 className="text-white font-bold mb-3">تقدم الأهداف</h4>
                                                        <div className="progress-bar">
                                                            <div 
                                                                className="progress-fill bg-blue-500" 
                                                                style={{ width: `${goalProgress}%` }}
                                                            ></div>
                                                        </div>
                                                        <div className="text-white text-center mt-2">
                                                            {currentChild.goals.filter(g => g.completed).length} / {currentChild.goals.length} ({goalProgress.toFixed(1)}%)
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        {appState.activeTab === "الجدول" && (
                                            <div>
                                                <div className="flex justify-between items-center mb-4">
                                                    <h3 className="text-2xl font-bold text-white">الجدول اليومي - {utils.getCurrentDay()}</h3>
                                                    {studyTimer.active && (
                                                        <button
                                                            onClick={stopStudyTimer}
                                                            className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                                                        >
                                                            ⏹️ إيقاف المؤقت - {studyTimer.currentSubject}
                                                        </button>
                                                    )}
                                                </div>
                                                {dailyPlan.length === 0 ? (
                                                    <div className="text-center py-8">
                                                        <p className="text-white text-lg mb-4">لم يتم إنشاء الجدول اليومي بعد</p>
                                                        <p className="text-white opacity-80">انقر على "توليد الجدول" لإنشاء جدول اليوم</p>
                                                    </div>
                                                ) : (
                                                    <div className="space-y-3">
                                                        {dailyPlan.map((item) => (
                                                            <div 
                                                                key={item.id} 
                                                                className={`glass-effect rounded-2xl p-4 transition-all ${
                                                                    currentChild.completed.includes(item.id) ? 'bg-green-500 bg-opacity-20' : ''
                                                                }`}
                                                            >
                                                                <div className="flex justify-between items-center">
                                                                    <div className="flex-1">
                                                                        <div className="text-white font-bold text-lg">{item.activity}</div>
                                                                        <div className="text-white opacity-80">{item.time}</div>
                                                                        {item.duration && (
                                                                            <div className="text-white opacity-60 text-sm">{item.duration} دقيقة</div>
                                                                        )}
                                                                    </div>
                                                                    <div className="flex gap-2">
                                                                        {item.type === "study" && !studyTimer.active && (
                                                                            <button
                                                                                onClick={() => startStudyTimer(item.activity)}
                                                                                className="bg-green-500 text-white p-2 rounded-xl hover:bg-green-600 transition-all"
                                                                            >
                                                                                بدء الدراسة
                                                                            </button>
                                                                        )}
                                                                        <button
                                                                            onClick={() => toggleComplete(item.id)}
                                                                            className={`p-2 rounded-xl transition-all ${
                                                                                currentChild.completed.includes(item.id)
                                                                                    ? 'bg-green-500 text-white'
                                                                                    : 'glass-effect text-white hover:bg-white hover:bg-opacity-20'
                                                                            }`}
                                                                        >
                                                                            {currentChild.completed.includes(item.id) ? '✓ مكتمل' : 'إنجاز'}
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                        )}

                                        {appState.activeTab === "الاختبارات" && (
                                            <div>
                                                <div className="flex justify-between items-center mb-4">
                                                    <h3 className="text-2xl font-bold text-white">الاختبارات القادمة</h3>
                                                    <button
                                                        onClick={() => {
                                                            const subject = prompt("اسم المادة:");
                                                            if (!subject) return;
                                                            const date = prompt("تاريخ الاختبار (YYYY-MM-DD):");
                                                            if (!date) return;
                                                            
                                                            const newExam = {
                                                                subject,
                                                                date,
                                                                time: prompt("وقت الاختبار (اختياري):") || "",
                                                                importance: "عادي",
                                                                notes: "",
                                                                id: utils.generateId(),
                                                                createdAt: new Date().toISOString()
                                                            };
                                                            
                                                            updateChild(appState.currentChildIndex, {
                                                                exams: [...currentChild.exams, newExam]
                                                            });
                                                            showNotification(`تمت إضافة اختبار ${subject}`, "success");
                                                        }}
                                                        className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                                                    >
                                                        + اختبار جديد
                                                    </button>
                                                </div>

                                                <div className="space-y-3">
                                                    {currentChild.exams.length === 0 ? (
                                                        <div className="text-center py-8">
                                                            <p className="text-white text-lg">لا توجد اختبارات مسجلة</p>
                                                        </div>
                                                    ) : (
                                                        currentChild.exams.map((exam, index) => (
                                                            <div key={exam.id} className="glass-effect rounded-2xl p-4">
                                                                <div className="flex justify-between items-start">
                                                                    <div className="flex-1">
                                                                        <div className="text-white font-bold text-lg">{exam.subject}</div>
                                                                        <div className="text-white opacity-80">
                                                                            📅 {exam.date} {exam.time && `• ⏰ ${exam.time}`}
                                                                        </div>
                                                                        <div className="flex gap-2 mt-2">
                                                                            <span className={`px-2 py-1 rounded text-sm ${
                                                                                exam.importance === "مهم جداً" ? "bg-red-500 text-white" :
                                                                                exam.importance === "مهم" ? "bg-orange-500 text-white" :
                                                                                "bg-blue-500 text-white"
                                                                            }`}>
                                                                                {exam.importance}
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <button 
                                                                        onClick={() => {
                                                                            updateChild(appState.currentChildIndex, {
                                                                                exams: currentChild.exams.filter((_, i) => i !== index)
                                                                            });
                                                                            showNotification("تم حذف الاختبار", "info");
                                                                        }}
                                                                        className="text-red-400 hover:text-red-300 p-2"
                                                                    >
                                                                        حذف
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ))
                                                    )}
                                                </div>
                                            </div>
                                        )}

                                        {appState.activeTab === "الأهداف" && (
                                            <div>
                                                <div className="flex justify-between items-center mb-4">
                                                    <h3 className="text-2xl font-bold text-white">الأهداف التعليمية</h3>
                                                    <button
                                                        onClick={() => {
                                                            const title = prompt("عنوان الهدف:");
                                                            if (!title) return;
                                                            
                                                            const newGoal = {
                                                                title,
                                                                targetDate: prompt("تاريخ الهدف (YYYY-MM-DD):") || "",
                                                                priority: "متوسط",
                                                                description: prompt("وصف الهدف (اختياري):") || "",
                                                                id: utils.generateId(),
                                                                createdAt: new Date().toISOString(),
                                                                completed: false,
                                                                progress: 0
                                                            };
                                                            
                                                            updateChild(appState.currentChildIndex, {
                                                                goals: [...currentChild.goals, newGoal]
                                                            });
                                                            showNotification("تمت إضافة الهدف بنجاح", "success");
                                                        }}
                                                        className="bg-blue-500 text-white p-3 rounded-xl hover:bg-blue-600 transition-all"
                                                    >
                                                        + هدف جديد
                                                    </button>
                                                </div>

                                                <div className="space-y-3">
                                                    {currentChild.goals.length === 0 ? (
                                                        <div className="text-center py-8">
                                                            <p className="text-white text-lg">لا توجد أهداف مسجلة</p>
                                                        </div>
                                                    ) : (
                                                        currentChild.goals.map((goal) => (
                                                            <div 
                                                                key={goal.id} 
                                                                className={`glass-effect rounded-2xl p-4 transition-all ${
                                                                    goal.completed ? 'bg-green-500 bg-opacity-20' : ''
                                                                }`}
                                                            >
                                                                <div className="flex justify-between items-start">
                                                                    <div className="flex-1">
                                                                        <div className="text-white font-bold text-lg">{goal.title}</div>
                                                                        {goal.targetDate && (
                                                                            <div className="text-white opacity-80">📅 {goal.targetDate}</div>
                                                                        )}
                                                                        {goal.description && (
                                                                            <div className="text-white opacity-60 mt-2">{goal.description}</div>
                                                                        )}
                                                                        <div className="flex gap-2 mt-2">
                                                                            <span className={`px-2 py-1 rounded text-sm text-white ${
                                                                                goal.priority === "مرتفع" ? "priority-high" :
                                                                                goal.priority === "متوسط" ? "priority-medium" :
                                                                                "priority-low"
                                                                            }`}>
                                                                                {goal.priority}
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <button
                                                                        onClick={() => {
                                                                            const updatedGoals = currentChild.goals.map(g =>
                                                                                g.id === goal.id 
                                                                                    ? { ...g, completed: !g.completed }
                                                                                    : g
                                                                            );
                                                                            const starsChange = !goal.completed ? 5 : -5;
                                                                            
                                                                            updateChild(appState.currentChildIndex, {
                                                                                goals: updatedGoals,
                                                                                stars: Math.max(0, currentChild.stars + starsChange)
                                                                            });

                                                                            if (!goal.completed) {
                                                                                showNotification(`🎉 مبروك! أكملت الهدف "${goal.title}" وكسبت 5 نجوم`, "success");
                                                                            }
                                                                        }}
                                                                        className={`p-3 rounded-xl transition-all ${
                                                                            goal.completed 
                                                                                ? 'bg-green-500 text-white' 
                                                                                : 'bg-gray-500 text-white hover:bg-gray-600'
                                                                        }`}
                                                                    >
                                                                        {goal.completed ? '✓ مكتمل' : 'غير مكتمل'}
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ))
                                                    )}
                                                </div>
                                            </div>
                                        )}

                                        {appState.activeTab === "المكافآت" && (
                                            <div>
                                                <div className="flex justify-between items-center mb-4">
                                                    <h3 className="text-2xl font-bold text-white">المكافآت المتاحة</h3>
                                                    <div className="flex gap-2">
                                                        <div className="bg-yellow-500 text-white p-3 rounded-xl">
                                                            ⭐ {currentChild.stars} نجمة
                                                        </div>
                                                        <button
                                                            onClick={() => {
                                                                const name = prompt("اسم المكافأة:");
                                                                if (!name) return;
                                                                const starsRequired = parseInt(prompt("النجوم المطلوبة:"));
                                                                if (isNaN(starsRequired)) return;
                                                                
                                                                const newRewardObj = {
                                                                    name,
                                                                    starsRequired,
                                                                    icon: "🎁",
                                                                    id: utils.generateId(),
                                                                    type: "custom",
                                                                    createdAt: new Date().toISOString()
                                                                };

                                                                setRewards(prev => [...prev, newRewardObj]);
                                                                showNotification("تمت إضافة المكافأة بنجاح", "success");
                                                            }}
                                                            className="bg-purple-500 text-white p-3 rounded-xl hover:bg-purple-600 transition-all"
                                                        >
                                                            + مكافأة جديدة
                                                        </button>
                                                    </div>
                                                </div>

                                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                                    {rewards.length === 0 ? (
                                                        <div className="col-span-full text-center py-8">
                                                            <p className="text-white text-lg">لا توجد مكافآت متاحة</p>
                                                        </div>
                                                    ) : (
                                                        rewards.map(reward => (
                                                            <div key={reward.id} className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                                                <div className="text-3xl mb-2">{reward.icon}</div>
                                                                <div className="text-white font-bold text-lg mb-2">{reward.name}</div>
                                                                <div className="text-yellow-400 font-bold text-xl mb-3">{reward.starsRequired} ⭐</div>
                                                                <div className="flex gap-2">
                                                                    <button
                                                                        onClick={() => {
                                                                            if (currentChild.stars >= reward.starsRequired) {
                                                                                updateChild(appState.currentChildIndex, {
                                                                                    stars: currentChild.stars - reward.starsRequired
                                                                                });
                                                                                showNotification(`🎉 مبروك! استبدلت ${reward.starsRequired} نجمة ب${reward.name}`, "success");
                                                                            } else {
                                                                                showNotification("❌ النجوم غير كافية", "error");
                                                                            }
                                                                        }}
                                                                        disabled={currentChild.stars < reward.starsRequired}
                                                                        className={`flex-1 p-2 rounded-xl transition-all ${
                                                                            currentChild.stars >= reward.starsRequired
                                                                                ? 'bg-green-500 hover:bg-green-600 text-white'
                                                                                : 'bg-gray-500 cursor-not-allowed text-white'
                                                                        }`}
                                                                    >
                                                                        {currentChild.stars >= reward.starsRequired ? 'استبدال' : 'نقاط غير كافية'}
                                                                    </button>
                                                                    {reward.type === "custom" && (
                                                                        <button
                                                                            onClick={() => {
                                                                                setRewards(prev => prev.filter(r => r.id !== reward.id));
                                                                                showNotification("تم حذف المكافأة", "info");
                                                                            }}
                                                                            className="bg-red-500 text-white p-2 rounded-xl hover:bg-red-600 transition-all"
                                                                        >
                                                                            حذف
                                                                        </button>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        ))
                                                    )}
                                                </div>
                                            </div>
                                        )}

                                        {appState.activeTab === "التقارير" && (
                                            <div className="space-y-6">
                                                <h3 className="text-2xl font-bold text-white">التقارير والإحصائيات</h3>
                                                
                                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                    <div className="glass-effect rounded-2xl p-4 text-center">
                                                        <div className="text-2xl text-white mb-2">📊</div>
                                                        <div className="text-white font-bold">{Math.floor(currentChild.studyTime / 60)} د</div>
                                                        <div className="text-white opacity-80">وقت الدراسة هذا الأسبوع</div>
                                                    </div>
                                                    
                                                    <div className="glass-effect rounded-2xl p-4 text-center">
                                                        <div className="text-2xl text-white mb-2">⭐</div>
                                                        <div className="text-white font-bold">{currentChild.stars}</div>
                                                        <div className="text-white opacity-80">نجوم مكتسبة</div>
                                                    </div>
                                                    
                                                    <div className="glass-effect rounded-2xl p-4 text-center">
                                                        <div className="text-2xl text-white mb-2">🎯</div>
                                                        <div className="text-white font-bold">
                                                            {currentChild.goals.filter(g => g.completed).length}
                                                        </div>
                                                        <div className="text-white opacity-80">هدف مكتمل</div>
                                                    </div>
                                                </div>
                                                
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div className="glass-effect rounded-2xl p-4">
                                                        <h4 className="text-white font-bold mb-3">تقدم الدراسة</h4>
                                                        <div className="progress-bar">
                                                            <div 
                                                                className="progress-fill" 
                                                                style={{ width: `${studyProgress}%` }}
                                                            ></div>
                                                        </div>
                                                        <div className="text-white text-center mt-2">
                                                            {studyProgress.toFixed(1)}%
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="glass-effect rounded-2xl p-4">
                                                        <h4 className="text-white font-bold mb-3">تقدم الأهداف</h4>
                                                        <div className="progress-bar">
                                                            <div 
                                                                className="progress-fill bg-blue-500" 
                                                                style={{ width: `${goalProgress}%` }}
                                                            ></div>
                                                        </div>
                                                        <div className="text-white text-center mt-2">
                                                            {currentChild.goals.filter(g => g.completed).length} / {currentChild.goals.length} ({goalProgress.toFixed(1)}%)
                                                        </div>
                                                    </div>
                                                </div>

                                                <div className="glass-effect rounded-2xl p-4">
                                                    <h4 className="text-white font-bold mb-3">الإنجازات الأخيرة</h4>
                                                    <div className="space-y-2">
                                                        {currentChild.completed.length > 0 ? (
                                                            currentChild.completed.slice(-5).map((activityId, index) => (
                                                                <div key={index} className="flex items-center gap-2 p-2 bg-white bg-opacity-10 rounded-lg">
                                                                    <span className="text-green-400">✓</span>
                                                                    <span className="text-white">إكمال النشاط #{activityId}</span>
                                                                </div>
                                                            ))
                                                        ) : (
                                                            <p className="text-white text-center py-2">لا توجد إنجازات مسجلة بعد</p>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Initialize App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
